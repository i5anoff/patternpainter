<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<script src="../build/three.js"></script>
	<script src="../js/Detector.js"></script>
	<script src="../js/libs/stats.min.js"></script>
	<script src="../js/controls/OrbitControls.js"></script>

	<title>Scaffold</title>

	<link rel="stylesheet" type="text/css" href="./style/common.css">
</head>
<body>
	<div id="container"></div>
	<script>
		if ( ! Detector.webgl ) Detector.addGetWebGLMessage();

		var camera, scene, renderer, composer, stats, controls;
		var frame = 0;

		var globalColors = [];

		// get Colors and init
		fetch( './scripts/Color.json' ).then( res => {
			return res.json().then( json => {
				colors = json['Color_fantasy'][0].colors;
				for( var i in colors ) {
					var color = new THREE.Color( '#' + colors[i] );
					globalColors.push(color);
				}
			});
		}).then( () => {
			init();
			animate();
		});



		function init() {
			var w = window.innerWidth;
			var h = window.innerHeight;
			var d = 500;
			var GLOBAL_SIZE_FACTOR = w/1400;
			var bounding = w/2;


			// Camera and Scene 
			// -----------------------------------------------------------------------------------
			camera = new THREE.OrthographicCamera( w / - 2, w / 2, h / 2, h / - 2, 1, 4000 );
			camera = new THREE.PerspectiveCamera( 50, window.innerWidth / window.innerHeight, 1, 10 );
			camera.position.z = 800;

			scene = new THREE.Scene();
			scene.background = new THREE.Color( 0x000000 );
			scene.fog = new THREE.Fog( 0x000000, 900, 1200 );

			var axesHelper = new THREE.AxesHelper( 25 );
			scene.add( axesHelper );
			var gridHelper = new THREE.GridHelper( 100, 10 );
			scene.add( gridHelper );




			// Renderer 
			// -----------------------------------------------------------------------------------
			renderer = new THREE.WebGLRenderer( { antialias: true, preserveDrawingBuffer: true } );
			renderer.setPixelRatio( window.devicePixelRatio );
			renderer.setSize( window.innerWidth, window.innerHeight );
			// renderer.gammaInput = true
			// renderer.gammaOutput = true;



			// Post-processing EFX -----------------------------------------------------------------------------------
			// composer = new THREE.EffectComposer( renderer );
			// composer.addPass( new THREE.RenderPass( scene, camera ) );
			// var effect_bloomPass = new THREE.UnrealBloomPass( new THREE.Vector2( window.innerWidth, window.innerHeight ), 1.7, 0.67, 0.43 ); 
			// effect_bloomPass.renderToScreen = true;
			// composer.addPass( effect_bloomPass );


			// Stats / Gui / Controls -----------------------------------------------------------------------------------
			stats = new Stats();
			controls = new THREE.OrbitControls( camera, renderer.domElement );



			// Dom Manipulation -----------------------------------------------------------------------------------
			var container = document.getElementById( 'container' );
			container.appendChild( stats.dom );
			container.appendChild( renderer.domElement );

			window.addEventListener( 'resize', onWindowResize, false ); 
		}

		function onWindowResize() {

			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();

			renderer.setSize( window.innerWidth, window.innerHeight );

		}

		function animate() {

			requestAnimationFrame( animate );

			render();
			stats.update();

		}

		function render() {

			renderer.render( scene, camera );
			// composer.render();

		}
	</script>
</body>
</html>